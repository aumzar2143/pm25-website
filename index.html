<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PM2.5 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
font-family: sans-serif;
background: linear-gradient(135deg,#b31217,#e52d27);
margin:0;
padding:20px;
color:white;
text-align:center;
}
.container{
max-width:900px;
margin:auto;
}
.card{
background:rgba(0,0,0,0.85);
padding:20px;
border-radius:20px;
margin-bottom:20px;
}
button,select{
padding:12px;
border-radius:10px;
border:none;
margin:5px;
font-size:16px;
}
button{
background:#ffcc00;
font-weight:bold;
cursor:pointer;
}
.aqi{
font-size:65px;
font-weight:bold;
}
.status{
font-size:20px;
margin-top:10px;
}
</style>
</head>
<body>

<div class="container">

<h1>üëë PM2.5 ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</h1>

<div class="card">
<select id="province">
<option value="bangkok">‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£</option>
<option value="chiang-mai">‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</option>
<option value="chiang-rai">‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢</option>
<option value="lampang">‡∏•‡∏≥‡∏õ‡∏≤‡∏á</option>
<option value="khon-kaen">‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô</option>
<option value="nakhon-ratchasima">‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤</option>
<option value="chon-buri">‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
<option value="phuket">‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï</option>
<option value="songkhla">‡∏™‡∏á‡∏Ç‡∏•‡∏≤</option>
</select>
<button onclick="loadData()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
</div>

<div class="card">
<div class="aqi" id="value">--</div>
<div class="status" id="status"></div>
</div>

<div class="card">
<h3>üìä ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° PM2.5</h3>
<canvas id="chart"></canvas>
</div>

</div>

<script>

const TOKEN = "05dc64914ef2d1b7c4d2678a15450338e660ea53";

function getLevel(aqi){
if(aqi<=50) return "üü¢ ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ";
if(aqi<=100) return "üü° ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á";
if(aqi<=150) return "üü† ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û";
if(aqi<=200) return "üî¥ ‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û";
return "üü£ ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏°‡∏≤‡∏Å";
}

async function loadData(){
let province = document.getElementById("province").value;
let res = await fetch(`https://api.waqi.info/feed/${province}/?token=${TOKEN}`);
let data = await res.json();

if(data.status==="ok"){
let aqi = data.data.aqi;
document.getElementById("value").innerText = aqi;
document.getElementById("status").innerText = getLevel(aqi);
drawChart(data.data.forecast.daily.pm25);
}else{
alert("‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö TOKEN");
}
}

function drawChart(forecast){
let labels = forecast.map(d=>d.day);
let values = forecast.map(d=>d.avg);

new Chart(document.getElementById("chart"),{
type:"line",
data:{
labels:labels,
datasets:[{
label:"‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ PM2.5",
data:values
}]
}
});
}

loadData();

</script>

</body>
</html>
